DROP DATABASE NOTIFYTEC;

CREATE DATABASE IF NOT EXISTS NOTIFYTEC;

USE NOTIFYTEC;

CREATE TABLE IF NOT EXISTS SEMESTRE(
  ID BINARY(16) PRIMARY KEY NOT NULL,
  INICIO DATE,
  FIM DATE
);

CREATE TABLE IF NOT EXISTS DEPARTAMENTO(
  ID BINARY(16) PRIMARY KEY NOT NULL,
  NOME VARCHAR(100)
);

CREATE TABLE IF NOT EXISTS CURSO(
  ID BINARY(16) PRIMARY KEY NOT NULL,
  NOME VARCHAR(100),
  APELIDO VARCHAR(30),
  ATIVO BOOLEAN
);

CREATE TABLE IF NOT EXISTS PERIODO(
  ID BINARY(16) PRIMARY KEY NOT NULL,
  NUMERO INT,
  CURSOID BINARY(16),
  FOREIGN KEY (CURSOID) REFERENCES CURSO(ID)
);

CREATE TABLE IF NOT EXISTS USUARIO(
  ID BINARY(16) PRIMARY KEY NOT NULL,
  LOGIN VARCHAR(50),
  SENHA VARCHAR(60),
  PODEENVIAR BOOLEAN,
  ALTEROUSENHA BOOLEAN,
  EMAIL VARCHAR(100),
  TOKENRECUPERARSENHA VARCHAR(5),
  DATAVALIDADETOKEN DATETIME
);

CREATE TABLE IF NOT EXISTS PESSOA(
  ID BINARY(16) PRIMARY KEY NOT NULL,
  NOME VARCHAR(100),
  SOBRENOME VARCHAR(100),
  APELIDO VARCHAR(50),
  CPF VARCHAR(15),
  USUARIOID BINARY(16),
  FOREIGN KEY (USUARIOID) REFERENCES USUARIO(ID),
  DEPARTAMENTOID BINARY(16),
  FOREIGN KEY (DEPARTAMENTOID) REFERENCES DEPARTAMENTO(ID),
  ATIVO BOOLEAN
);

CREATE TABLE IF NOT EXISTS ALUNO(
  ID BINARY(16) PRIMARY KEY NOT NULL,
  NOME VARCHAR(100),
  SOBRENOME VARCHAR(100),
  RA VARCHAR(12),
  CPF VARCHAR(15),
  USUARIOID BINARY(16),
  FOREIGN KEY (USUARIOID) REFERENCES USUARIO(ID),
  ATIVO BOOLEAN
);

CREATE TABLE IF NOT EXISTS ALUNOPERIODO(
  ID BINARY(16) PRIMARY KEY NOT NULL,
  ALUNOID BINARY(16),
  FOREIGN KEY (ALUNOID) REFERENCES ALUNO(ID),
  PERIODOID BINARY(16),
  FOREIGN KEY (PERIODOID) REFERENCES PERIODO(ID),
  INICIO DATE,
  FIM DATE,
  SEMESTREID BINARY(16),
  FOREIGN KEY (SEMESTREID) REFERENCES SEMESTRE(ID)
);

CREATE TABLE IF NOT EXISTS NOTIFICACAO(
  ID BINARY(16) PRIMARY KEY NOT NULL,
  TITULO VARCHAR(100),
  CONTEUDO TEXT,
  ENQUETE BOOLEAN,
  EXPIRAEM DATETIME,
  USUARIOID BINARY(16),
  FOREIGN KEY (USUARIOID) REFERENCES USUARIO(ID),
  DATAHORAENVIO DATETIME
);

CREATE TABLE IF NOT EXISTS NOTIFICACAOOPCAO(
  ID BINARY(16) PRIMARY KEY NOT NULL,
  NOTIFICAOID BINARY(16),
  FOREIGN KEY (NOTIFICAOID) REFERENCES NOTIFICACAO(ID),
  NOME VARCHAR(100)
);

CREATE TABLE IF NOT EXISTS ALUNONOTIFICACAO(
  ID BINARY(16) PRIMARY KEY NOT NULL,
  NOTIFICACAOID BINARY(16),
  FOREIGN KEY (NOTIFICACAOID) REFERENCES NOTIFICACAO(ID),
  ALUNOID BINARY(16),
  FOREIGN KEY (ALUNOID) REFERENCES ALUNO(ID),
  VIZUALIZOUEM DATETIME,
  NOTIFICACAOOPCAOID BINARY(16),
  FOREIGN KEY (NOTIFICACAOOPCAOID) REFERENCES NOTIFICACAOOPCAO(ID)
);